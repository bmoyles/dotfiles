#!/bin/bash

funcdirs=(
  "${DOTLOCAL}"/shell/functions
  "${SHELLDOTDIR}"/functions
)

if [[ -n ${ZSH_NAME:-} ]]; then
  fpath=( "${funcdirs[@]}" "${fpath[@]}" )
  declare -U fpath
fi

if [[ -n ${BASH:-} ]]; then
  . "${SHELLDOTDIR}"/bash/autoload
  export FPATH=( "${funcdirs[@]}" )
fi

for funcdir in "${funcdirs[@]}"; do
  [[ -d ${funcdir} ]] || continue
  for funcfile in "${funcdir}"/*; do
    funcname="${funcfile##*/}"
    autoload "${funcname}"
  done
done
unset funcdirs funcname funcfile
